(:JIQS: ShouldRun; Output="" :)
let $data := structured-json-file("./src/main/resources/queries/rumbleML/sample-ml-data-sentence.json")

let $tokenizer := get-transformer("Tokenizer")
let $intermediate-data := $tokenizer($data, {"inputCol": "sentence", "outputCol": "output"})
let $df-intermediate-data := annotate($intermediate-data, {"id": "integer", "sentence": "string", "output": ["string"]})

let $hashingTF := get-transformer("HashingTF")
return $hashingTF($df-intermediate-data, {"inputCol": "output", "numFeatures": 2})

(: annotate does not support array types at the moment :)
